package service;

import java.net.URI;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.client.RestTemplate;

import com.monografia.servicoemitirnf.model.NotaFiscal;

@Componet
public class Faturamento {
	
	private static final Logger LOG = LoggerFactory.getLogger(Faturamento.class);

    @Autowired
    Util util;

    private RestTemplate restTemplate = new RestTemplate();
    
    // Emiss√£o NotaFiscal //
    
    public ResponseEntity<NotaFiscal> emitirNFSaida(int pedidoId) {
    	
    	URI uri = util.getServiceUrl("emitirnf", "http://localhost:8081/emitirnf");
        String url = uri.toString() + "/emitirnf/" + pedidoId;
        LOG.debug("EmitirNFSaida da URL: {}", url);

        ResponseEntity<String> resultStr = restTemplate.getForEntity(url, String.class);
        LOG.debug("EmitirNFSaida http-status: {}", resultStr.getStatusCode());
        LOG.debug("EmitirNFSaida body: {}", resultStr.getBody());

        NotaFiscal notaFiscal = response2Product(resultStr);
        LOG.debug("EmitirNFSaida.id: {}", product.getProductId());

        return util.createOkResponse(product);
    	
    }

}
